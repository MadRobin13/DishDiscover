<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="images\restaurant-17.png">
    <title>Create New Recipe</title>
</head>
<body>
    <div class="bg"></div>
    <div class="topBar">
        <img src="images\DishDiscover Logo.png" alt="logo" id="logoTop">
        <div class="topBarButtons">
            <img src="images\DishDiscover Logo (2).png" alt="writing logo" id="logoWrite">
            <a href="shop.html"><img src="./images/1413908.png" alt="shopping cart button" class="buttons"></a>
            <a href="create.html"><img src="./images/3658773.png" alt="create a recipe button" class="buttons"></a>
            <a href="info.html"><img src="./images/about-us-22.png" alt="about us button" class="buttons"></a>
            <a href="index.html"><img src="./images/find-icon.png" alt="find a recipe button" class="buttons"></a>
            <a href="business.html"><img src="./images/Suitcase_icon.svg.png" alt="business plan" class="buttonSuit"></a>
            <a href="example.html"><img src="images/thumbs-up-icon-512x494-o2379yaq.png" alt="food of the week" class="buttons"></a>
        </div>
    </div>
    <div class="bottomBar">
        <div class="contacts">
            <a href="https://forms.gle/a65Ec3S7bNT3WS6C8"><img src="./images/3095583.png" alt="contact us" id="contact"></a>
        </div>
    </div>

    <img src="images\top_ad_v2.png" alt="advertisement" id="adAPR" class="topAd">
    <br>
    <!-- <img src="images\DishDiscover Logo.png" alt="logo" class="logo"> -->
    <form id="createForm">
        <div class="createBox">
            <div class="createOrder">
            <!-- <label for="createImg" class="searchBar" id="createImgLabel">Image?</label>
            <input type="file" placeholder="Image?" class="searchBar" id="createImg"> -->
            <input type="text" placeholder=" Name?" class="searchBar" id="createName">
            <input type="text" placeholder=" Food?" class="searchBar" id="createFood">
            <textarea placeholder=" Ingredients?" class="searchBar" id="createIngredients"></textarea>
            <textarea placeholder=" Recipe?" class="searchBar" id="createRecipe"></textarea>
            <button type="submit" id="createButton" class="searchBar">Submit!</button>
            </div>
        </div>
    </form>
    <video type="video/webm" src="videos\business_ad.mp4" id="adVid" controls autoplay>An error occured with your browser (VIDEO_PERMISSION_ERROR: 500)</video>
</body>

<script>
    const vid = document.getElementById('adVid');

    vid.addEventListener('ended', () => {
        vid.currentTime = 0;
        vid.play();
    });

    vid.addEventListener('load', () => {
        vid.play();
    });
</script>

  
<script type="module">

  
    let submitBtn = document.getElementById('createButton');

    submitBtn.addEventListener('click', (e) => {

        let creator = document.getElementById('createName').value;
        let food = document.getElementById('createFood').value;
        let ingredients = document.getElementById('createIngredients').value;
        let recipe = document.getElementById('createRecipe').value;

        let ing = ingredients.split(',').map(ing => ing.trim());
        let rec = recipe.split(',').map(rec => rec.trim());

        let newFood = {
            creator: creator,
            food: food,
            ingredients: ing,
            recipe: rec
        }

        e.preventDefault();
        saveToJson(newFood);
        localStorage.setItem("newFood", JSON.stringify(newFood));
    });
</script>

<!-- <script>
    let recipes = [];

    function logData(recipes) {
        let creator = document.getElementById('createName').value;
        let food = document.getElementById('createFood').value;
        let ingredients = document.getElementById('createIngredients').value;
        let recipe = document.getElementById('createRecipe').value;

        let ing = ingredients.split(',').map(ing => ing.trim());
        let rec = recipe.split(',').map(step => step.trim());

        let newFood = {
            creator: creator,
            food: food,
            ingredients: ing,
            recipe: rec
        }

        recipes.push(newFood);
        localStorage.setItem("newFood", JSON.stringify(recipes));
        console.log(JSON.stringify(newFood));

    }
</script> -->

<!-- 
<script>
    const fs = require('fs').promises;
    const { MongoClient } = require('mongodb');


    let client;

    let theKey = '';

    async function readKey() {
        try {
            theKey = await fs.readFile('mongoKey', 'utf8');
            const uri = "mongodb+srv://mongo:" + theKey + "@java-coffee.06pqnyw.mongodb.net/?retryWrites=true&w=majority&appName=Java-Coffee";
            client = new MongoClient(uri);
        } catch (err) {
            console.error("Couldn't read from file: ", err);
            process.exit(1); 
        }
    }

    // main().catch(console.error);

    async function addRecipe(newFood) {

        await readKey();

        try {
            await client.connect();

            let creator = document.getElementById('createName').value;
            let food = document.getElementById('createFood').value;
            let ingredients = document.getElementById('createIngredients').value;
            let recipe = document.getElementById('createRecipe').value;

            let ing = ingredients.split(',').map(ing => ing.trim());
            let rec = recipe.split(',').map(step => step.trim());

            let newFood = {
                creator: creator,
                food: food,
                ingredients: ing,
                recipe: rec
            }

            await client.db("DishDiscover").collection("Recipes").insertOne(newFood);

            console.log(JSON.stringify(newFood));

        } catch (e) {
            console.error(e);
        } finally {
            await client.close();
        }

    }

    async function getRecipe(client, food, creator) {
        const recipe = await client.db("DishDiscover").collection("Recipes").findOne({ name: food, creator: creator });
        console.log(recipe);
    }

    async function doomsday(client) {
        await client.db("DishDiscover").collection("Recipes").deleteMany({});
    }
</script>

<script>
    // import { addRecipe } from "./script.js";
    function logData() {

        // localStorage.removeItem("newFood");


        addRecipe(newFood);

    }
</script> -->

</html>